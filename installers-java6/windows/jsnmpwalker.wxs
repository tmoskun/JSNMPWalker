<?xml version="1.0" encoding="utf-8"?>
<!--
    # This comment is generated by WixEdit, the specific commandline
    # arguments for the WiX Toolset are stored here.

    candleArgs: 
    lightArgs: "<projectname>.wixobj" -out "<projectname>-v2.5.msi" <extensions>
-->
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
    <Product Id="CF1097AA-421A-4B29-92F7-B062E140B819" Name="JSNMPWalker" Language="1033" Version="2.5" Manufacturer="ezcode" UpgradeCode="8AB73AAB-C275-4596-9177-E6315462D522">
        <Package Description="JSNMPWalker is a Java based application to run SNMP commands" Comments="Java 7 or above required" InstallerVersion="250" Compressed="yes" />
        <Media Id="1" Cabinet="jsnmpwalker.cab" EmbedCab="yes" />
        <Directory Id="TARGETDIR" Name="SourceDir">
            <Directory Id="ProgramFilesFolder" Name="PFiles">
                <Directory Id="JSNMPWALKER_DIR" Name="JSNMPWalker">
                    <Component Id="JSNMPWALKER_V2.5.JAR" DiskId="1" Guid="478A265E-958A-43A9-81A7-E887A9116E21">
                        <File Id="JSNMPWALKER_V2.5.JAR" Name="JSNMPWalker-v2.5.jar" Source="JSNMPWalker-v2.5.jar" />
                    </Component>
                    <Component Id="JSNMPWALKER.CMD" DiskId="1" Guid="FF8B3ABC-709B-4002-AD41-F15EA38B3668">
                        <File Id="JSNMPWALKER.CMD" Name="jsnmpwalker.cmd" Source="jsnmpwalker.cmd" KeyPath="yes">
                            <Shortcut Id="desktopShortcut" Directory="DesktopFolder" Name="JSNMPWalker" WorkingDirectory="INSTALLDIR" Advertise="yes" Icon="JSNMPWalkerIcon.ico" IconIndex="0" />
                            <Shortcut Id="ExeShortcut" Directory="ProgramMenuDir" Name="JSNMPWalker" Advertise="yes" Icon="JSNMPWalkerIcon.ico" IconIndex="0" />
                        </File>
                    </Component>
                    <Component Id="LICENSE_GNU_GPLV3.TXT" DiskId="1" Guid="DA6C1229-7DD0-4E28-8463-30442743EB41">
                        <File Id="LICENSE_GNU_GPLV3.TXT" Name="LICENSE-GNU GPLv3.txt" Source="LICENSE-GNU_GPLv3.txt" />
                    </Component>
                    <Component Id="README.MD" DiskId="1" Guid="D16455CD-AE17-463B-8B47-3D75465E8A76">
                        <File Id="README.MD" Name="README.md" Source="README.md" />
                    </Component>
                    <Component Id="VERSION.TXT" DiskId="1" Guid="BA279B5B-FDA7-4335-9FAE-C53C2FC961C9">
                        <File Id="VERSION.TXT" Name="Version.txt" Source="Version.txt" />
                    </Component>
                    <Directory Id="LICENSE" Name="LICENSE">
                        <Component Id="LICENSE_MIBBLE.TXT" DiskId="1" Guid="62DA77CC-8A36-4F29-80FF-4A2182B48F2D">
                            <File Id="LICENSE_MIBBLE.TXT" Name="LICENSE-Mibble.txt" Source="LICENSE\LICENSE-Mibble.txt" />
                        </Component>
                        <Component Id="LICENSE_SNMP4J.TXT" DiskId="1" Guid="0DFE56F8-AB74-4EAE-9062-0C30B8EB42F7">
                            <File Id="LICENSE_SNMP4J.TXT" Name="LICENSE-snmp4j.txt" Source="LICENSE\LICENSE-snmp4j.txt" />
                        </Component>
                        <Component Id="LICENSE.LOG4J_1" DiskId="1" Guid="DAD7DDFB-29A3-4504-99BA-4B7A85492287">
                            <File Id="LICENSE.LOG4J_1" Name="LICENSE.log4j" Source="LICENSE\LICENSE.log4j" />
                        </Component>
                        <Component Id="NOTICE_SNMP4J" DiskId="1" Guid="625574AE-8B32-4434-B700-852DD1A6B010">
                            <File Id="NOTICE_SNMP4J" Name="NOTICE-snmp4j" Source="LICENSE\NOTICE-snmp4j" />
                        </Component>
                    </Directory>
                </Directory>
            </Directory>
            <Directory Id="DesktopFolder" />
            <Directory Id="ProgramMenuFolder" Name="Programs">
                <Directory Id="ProgramMenuDir" Name="JSNMPWalker">
                    <Component Id="StartMenuShortcuts" Guid="5DBB45BB-A881-4CB9-AC67-BC3349278D55">
                        <Shortcut Id="startmenuJSNMPWalker" Name="JSNMPWalker" WorkingDirectory="JSNMPWALKER_DIR" Icon="JSNMPWalkerIcon.ico" IconIndex="0" Target="[SYSTEMFOLDER]cmd.exe" Arguments="/k jsnmpwalker" />
                        <Shortcut Id="startmenuReadme" Name="Readme" WorkingDirectory="JSNMPWALKER_DIR" Icon="ReadmeIcon.ico" IconIndex="0" Target="[JSNMPWALKER_DIR]README.md" />
                        <RemoveFolder Id="ProgramMenuDir" On="uninstall" />
                        <RemoveFolder Id="JSNMPWalker" On="uninstall" />
                        <RegistryValue Root="HKCU" Key="Software\[Manufacturer]\[ProductName]" Type="string" Value="" />
                        <Shortcut Id="UninstallProduct" Name="Uninstall JSNMPWalker" Description="Uninstall JSNMPWalker" Target="[System64Folder]msiexec.exe" Arguments="/x [ProductCode]" />
                    </Component>
                </Directory>
            </Directory>
        </Directory>
        <Feature Id="DefaultFeature" Title="Main Feature" Level="1">
            <ComponentRef Id="JSNMPWALKER_V2.5.JAR" />
            <ComponentRef Id="JSNMPWALKER.CMD" />
            <ComponentRef Id="LICENSE_GNU_GPLV3.TXT" />
            <ComponentRef Id="README.MD" />
            <ComponentRef Id="VERSION.TXT" />
            <ComponentRef Id="LICENSE_MIBBLE.TXT" />
            <ComponentRef Id="LICENSE_SNMP4J.TXT" />
            <ComponentRef Id="LICENSE.LOG4J_1" />
            <ComponentRef Id="NOTICE_SNMP4J" />
            <ComponentRef Id="StartMenuShortcuts" />
        </Feature>
        <Property Id="JAVA_CURRENT_VERSION">
            <RegistrySearch Id="JRE_KEY" Root="HKLM" Key="SOFTWARE\JavaSoft\Java Runtime Environment" Name="CurrentVersion" Type="raw" />
        </Property>
        <Property Id="ARPPRODUCTICON" Value="JSNMPWalkerIcon.ico" />
        <Icon Id="ReadmeIcon.ico" SourceFile="..\..\Windows\notepad.exe" />
        <Icon Id="JSNMPWalkerIcon.ico" SourceFile="icons\jsnmpwalker.ico" />
        <UIRef Id="WixUI_Minimal" />
        <UIRef Id="WixUI_ErrorProgressText" />
        <UI />
        <WixVariable Id="WixUILicenseRtf" Value="LICENSE-GNU_GPLv3.rtf" />
        <Condition Message="Java 7 not installed. Please, install JRE 1.7 or later"><![CDATA[(Installed OR JAVA_CURRENT_VERSION) AND JAVA_CURRENT_VERSION >= "1.7"]]></Condition>
    </Product>
</Wix>